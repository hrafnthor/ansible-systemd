{
    "title": "pipx",
    "description": "schema for systemd configuration",
    "type": "object",
    "properties":
    {
        "units":
        {
            "type": "array",
            "items":
            {
                "type": "object",
                "properties":
                {
                    "remove":
                    {
                        "description": "Indicates if the unit file present at the path defined in variable 'dest' with the name as defined in 'name' should be removed.",
                        "type": "boolean"
                    },
                    "src":
                    {
                        "description": "The source path for the unit file being configured.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "vars":
                    {
                        "description": "Dictionary of variables to pass on to the templating task.",
                        "type": "object"
                    },
                    "dest":
                    {
                        "description": "The directory path to where the unit file should be placed. If omitted, the default value is used.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "owner":
                    {
                        "description": "The owner of the unit file",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "group":
                    {
                        "description": "The group owning the unit file",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "mode":
                    {
                        "description": "The access mode of the unit file",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "name":
                    {
                        "description": "The name to give the unit file. This should be without the suffix as it will be spliced automatically based on the 'kind' selection.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "enabled":
                    {
                        "description": "Indicates if the unit should be made to start at system boot up.",
                        "type": "boolean"
                    },
                    "state":
                    {
                        "description": "The state that the unit should be set to",
                        "type": "string",
                        "enum":
                        [
                            "stopped",
                            "started",
                            "restarted",
                            "reloaded"
                        ]
                    },
                    "kind":
                    {
                        "type": "string",
                        "enum":
                        [
                            "service",
                            "socket",
                            "device",
                            "mount",
                            "automount",
                            "swap",
                            "target",
                            "path",
                            "timer",
                            "snapshot",
                            "slice",
                            "scope"
                        ]
                    }
                },
                "required":
                [
                    "name",
                    "kind"
                ],
                "if":
                {
                    "properties":
                    {
                        "remove":
                        {
                            "const": false
                        }
                    }
                },
                "then":
                {
                    "required":
                    [
                        "src"
                    ]
                },
                "else":
                {}
            }
        },
        "credentials":
        {
            "type": "array",
            "items":
            {
                "type": "object",
                "properties":
                {
                    "name":
                    {
                        "description": "The credential name to embed in the encrypted credential data. This will also be used as the name of the file containing the credential.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "not_after":
                    {
                        "description": "The time when the credential shall not be used anymore. Takes a timestamp specification in the format described in systemd.time(7).",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "timestamp":
                    {
                        "description": "The timestamp to embed into the encrypted credential. Takes a timestamp specification in the format described in systemd.time(7).",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "user":
                    {
                        "description": "A user name or numeric UID to encrypt the credential for. If set to the special string self it sets the user to the user of the calling process. Requires systemd 256 or later.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "value":
                    {
                        "description": "The credential value to set",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "variable":
                    {
                        "description": "The name of the variable holding the credential value to set.",
                        "$ref": "#/definitions/non-empty-string"
                    },
                    "remove":
                    {
                        "description": "Indicates if the file containing the encrypted credential should be removed. Defaults to false.",
                        "type": "boolean"
                    }
                },
                "oneOf":
                [
                    {
                        "required":
                        [
                            "name",
                            "value"
                        ]
                    },
                    {
                        "required":
                        [
                            "name",
                            "variable"
                        ]
                    }
                ]
            }
        }
    },
    "definitions":
    {
        "non-empty-string":
        {
            "type": "string",
            "minLength": 1
        },
        "non-empty-string-array":
        {
            "type": "array",
            "minItems": 1,
            "items":
            {
                "$ref": "#/definitions/non-empty-string"
            }
        }
    }
}
